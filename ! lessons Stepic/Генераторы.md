---
tags:
  - Python
---

---
Дата создания: 2024-12-01 13:12
Дата последнего изменения: 2024-12-01 13:12
---
## Основные идеи
1) 
---
### Функции генераторы
**Функция генератор** - это функция, которая возвращает итератор. Она выглядит как обычная функция, но и использованием выражения `yield`.

При каждом вызове функция генератор сохраняет локальные переменные от вызова к вызову. Это своего рода возобновляемая функция.

Генератор – это итератор, который порождает значения, переданные yield. Когда выполнение доходит до конца функции, объект генератор возбуждает исключение StopIteration в полном соответствии с протоколом итератора.
### Принцип работы
``` python
def generate_AB(): 
    print('start') 
    yield 'A' 
    print('continue') 
    yield 'B' 
    print('end') 
    
    
for char in generate_AB(): 
    print('-->', char)

# start 
# --> A 
# continue 
# --> B 
# end
```

Цикл `for` преобразует выражение в в итератор. В теле цикла на каждой итерации печатается `-->` и значение, полученное при вызове `next(iterator)`

Во время первой итерации и первом вызове `next(iterator)` генератор, перед тем как сгенерировать значение `'A'` (то есть дойти до строки `yield 'A'`), сначала выполняет строку `print('start')`.

Во время второй итерации и втором вызове `next(iterator)` генератор, перед тем как сгенерировать значение `'B'` (то есть дойти до строки `yield 'B'`), сначала выполняет строку `print('continue')`.

Во время третьей итерации и третьем вызове `next(iterator)` генератор выполняет строку `print('end')` и завершает свою работу, возбуждая исключение `StopIteration`. Цикл `for` перехватывает это исключение и нормально завершается.

## `return`

До версии Python 3.3 наличие ключевого слова `return` внутри фукнции генератора приводило к возникновению ошибки:  `Syntaxerror`.

Теперь использование `return`  приводит к возбуждению исключения `StopIteration`.

## Особенности и ограничения функций генераторов

Основные особенности, присущие всем функциям генераторам:

- любая функция, содержащая ключевое слово `yield`, является функцией генератором
- когда вызывается функция генератор, то она **не возвращает единственное значение**, как это делает обыкновенная функция
- функция генератор всегда возвращает объект типа `generator`, который поддерживает протокол итератора

Разница между `yield` и оператором `return` заключается в том, что для ключевого слова `yield` состояние выполнения генератора приостанавливается и локальные переменные сохраняются. При следующем вызове метода генератора `__next__()` функция возобновляет свое выполнение из той точки, из которой завершила в прошлый раз.

Генератор является итератором, поэтому он обладает всеми его особенностями:

- нельзя получить длину генератора функцией `len()`
- нельзя распечатать элементы генератора функцией `print()` без предварительной распаковки
- у генератора нельзя получить элемент по индексу
- после итерации по генератору он становится пустым


### Примеры

``` python
# последовательность числе от low до high включительно
def counter(low, high): 
    for num in range(low, high + 1): 
        yield num
```

### Примечания

1) Функция генератор и генераторная функция - это одно и то же.
2) Генератор - это итерируемый объект.
3) Итерируемый объект и итератор – это протоколы, то есть правила реализации. Генератор – это не протокол, а конкретная реализация. Это специальный механизм в языке Python, который позволяет создать однократно перебираемую функцию, логика перебора которой легко и красиво описывается.
4) Единственное синтаксическое различие между обычной функцией и функцией генератором – тот факт, что в теле последней встречается ключевое слово `yield`. Многие разработчики из команды Python считали, что для функций генераторов следовало бы ввести новое ключевое слово `gen` вместо `def`, но Гвидо не согласился.
5) За кулисами генераторной функции создается итератор


---
## Ресурсы:
1) [Поколение 1](https://stepik.org/lesson/640048/step/1?unit=636568)
2) [Док к функциям?](https://docs.python.org/3/reference/expressions.html#generator-iterator-methods)
