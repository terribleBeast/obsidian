## Подсчет ссылок
Алгоритм подсчета ссылка: объекты удаляются как только на них больше нет ссылок.

PyObject - базовый класс, от которого унаследованы все объекты. Поля: `Reference Count (ob_refcnt)` - количество ссылок на объект, `type`, `value`. Если `RC` равно нулю, то объект удаляется.

Основные сценарии изменения значения счетчика:

Увеличение счетчика ссылок:
* создание нового объекта и присвоение его переменной
* присвоение уже существующего объекта переменной
* передача объекта в функцию в качестве аргумента
* добавление объекта в список, множество, словарь и т. д.

Уменьшение счетчика ссылок:
- удаление объекта из области видимости функции после её завершения
- удаление переменной с помощью оператора del
- переприсваивание переменной нового значения 
- удаление объекта из списка, множества, словаря и т.д.
Для получения количества ссылок на объект используется функция  `sys.getrefcount()`

``` python
import sys
nums = [1, 2, 3]

print(sys.getrefcount(nums)) # 2
```
Получили 2 ссылки, так как объявление переменной значение счетчика было увеличено на 1, затем при передачи объекта `nums` в функцию, счетчик также был увеличен.


#### Вечный счетчик
 Недостаток алгоритмы подсчета ссылок: не умение определения циклических ссылок 
``` python

# пример 1
nums1 = [1, 2, 3]
nums2 = [4, 5]

nums1.append(nums2)
nums2.append(nums1)

# пример 2
nums = [1, 2]
nums.append(nums)
```
1) Создаст циклические ссылки, так как `nums1` содержит ссылку на `nums2` и наоборот. Таким образом, счетчики ссылок у объектов никогда не будут равны нулю.
2) Ссылка на самого себя

Из-за этого в Python существует дополнительный механизм очистки памяти - сборщик мусора (Garbage Collector), который следит за объектами с потенциальными циклическими ссылками.

RC не может быть отключен

Примечание: 
Количество ссылок на определенный объект иногда может оказаться заметно больше, чем кажется на первый взгляд.

``` python
import sys 
print(sys.getrefcount(0)) # число 0 
print(sys.getrefcount(1)) # число 1 
print(sys.getrefcount('')) # пустая строка 
print(sys.getrefcount(())) # пустой кортеж

#output
# 164
# 84
# 58
# 1257
```

Причина: многие иммутабельные объекты уже используются, например, в реализациях встроенных функций и типов данных. Изменяемые объекты не подвержены данной особенности, так как изменение такого объекта в одной части программы привело бы к его изменению в другой части программы.


Статья об отключении сборщика мусора в [Instagram](https://habr.com/ru/company/wunderfund/blog/328404/)

Существуют слабые ссылки, которые не увеличивают счетчик ссылок и тем самым, не препятствуют удалению объекта. [ссылка](https://docs-python.ru/standart-library/modul-weakref-python/) 

Визуализация Python объектов с помощью модуля `objgraph`